<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¦»çº¿æ¨¡å¼æµ‹è¯•</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="fonts/material-symbols-rounded.css">
    <link rel="stylesheet" href="styles/offline-icons.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        
        .test-section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #f9f9f9;
        }
        
        .status-display {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: 500;
        }
        
        .status-online {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status-offline {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .icon-test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .icon-test-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: white;
            border-radius: 6px;
            border: 1px solid #eee;
        }
        
        .search-engine-test {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 6px;
            border: 1px solid #eee;
        }
        
        .test-controls {
            margin: 20px 0;
        }
        
        .test-btn {
            background: #4285f4;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        
        .test-btn:hover {
            background: #3367d6;
        }
        
        .test-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .log-area {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 15px;
            font-family: monospace;
            font-size: 13px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª ç¦»çº¿æ¨¡å¼æµ‹è¯•</h1>
    
    <div id="network-status" class="status-display">
        æ£€æµ‹ç½‘ç»œçŠ¶æ€ä¸­...
    </div>
    
    <div class="test-section">
        <h2>ğŸŒ ç½‘ç»œçŠ¶æ€æ§åˆ¶</h2>
        <p>ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·æ¨¡æ‹Ÿç¦»çº¿çŠ¶æ€ï¼š</p>
        <ol>
            <li>æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·</li>
            <li>åˆ‡æ¢åˆ° Network é¢æ¿</li>
            <li>ç‚¹å‡» "Offline" å¤é€‰æ¡†æ¨¡æ‹Ÿç¦»çº¿çŠ¶æ€</li>
            <li>è§‚å¯Ÿé¡µé¢å˜åŒ–</li>
        </ol>
        
        <div class="test-controls">
            <button class="test-btn" onclick="testNetworkStatus()">æ£€æµ‹å½“å‰ç½‘ç»œçŠ¶æ€</button>
            <button class="test-btn" onclick="simulateOffline()">æ¨¡æ‹Ÿç¦»çº¿æ¨¡å¼</button>
            <button class="test-btn" onclick="simulateOnline()">æ¨¡æ‹Ÿåœ¨çº¿æ¨¡å¼</button>
        </div>
    </div>
    
    <div class="test-section">
        <h2>ğŸ” æœç´¢å¼•æ“å›¾æ ‡æµ‹è¯•</h2>
        <p>åœ¨ç¦»çº¿çŠ¶æ€ä¸‹ï¼Œå¤–éƒ¨å›¾æ ‡ä¼šè¢«æ›¿æ¢ä¸ºæœ¬åœ°ç»˜åˆ¶çš„å›¾æ ‡ï¼š</p>
        
        <div class="search-engine-test">
            <img src="https://www.google.com/favicon.ico" alt="Google" class="search-engine-icon">
            <div class="search-engine-icon offline-google" style="display: none;"></div>
            <span>Google æœç´¢</span>
        </div>
        
        <div class="search-engine-test">
            <img src="https://www.bing.com/favicon.ico" alt="Bing" class="search-engine-icon">
            <div class="search-engine-icon offline-bing" style="display: none;"></div>
            <span>Bing æœç´¢</span>
        </div>
        
        <div class="search-engine-test">
            <img src="https://www.baidu.com/favicon.ico" alt="Baidu" class="search-engine-icon">
            <div class="search-engine-icon offline-baidu" style="display: none;"></div>
            <span>ç™¾åº¦æœç´¢</span>
        </div>
        
        <div class="search-engine-test">
            <img src="https://duckduckgo.com/favicon.ico" alt="DuckDuckGo" class="search-engine-icon">
            <div class="search-engine-icon offline-duckduckgo" style="display: none;"></div>
            <span>DuckDuckGo æœç´¢</span>
        </div>
    </div>
    
    <div class="test-section">
        <h2>ğŸ¨ Material Symbols å›¾æ ‡æµ‹è¯•</h2>
        <p>è¿™äº›å›¾æ ‡ä½¿ç”¨æœ¬åœ°å­—ä½“ï¼Œåœ¨ç¦»çº¿çŠ¶æ€ä¸‹åº”è¯¥æ­£å¸¸æ˜¾ç¤ºï¼š</p>
        
        <div class="icon-test-grid">
            <div class="icon-test-item">
                <span class="material-symbols-rounded">search</span>
                <span>search</span>
            </div>
            <div class="icon-test-item">
                <span class="material-symbols-rounded">palette</span>
                <span>palette</span>
            </div>
            <div class="icon-test-item">
                <span class="material-symbols-rounded">grid_view</span>
                <span>grid_view</span>
            </div>
            <div class="icon-test-item">
                <span class="material-symbols-rounded">view_list</span>
                <span>view_list</span>
            </div>
            <div class="icon-test-item">
                <span class="material-symbols-rounded">add</span>
                <span>add</span>
            </div>
            <div class="icon-test-item">
                <span class="material-symbols-rounded">sync</span>
                <span>sync</span>
            </div>
            <div class="icon-test-item">
                <span class="material-symbols-rounded">download</span>
                <span>download</span>
            </div>
            <div class="icon-test-item">
                <span class="material-symbols-rounded">cloud_upload</span>
                <span>cloud_upload</span>
            </div>
        </div>
    </div>
    
    <div class="test-section">
        <h2>ğŸ“ æµ‹è¯•æ—¥å¿—</h2>
        <div id="test-log" class="log-area">
            ç­‰å¾…æµ‹è¯•å¼€å§‹...
        </div>
        <div class="test-controls">
            <button class="test-btn" onclick="clearLog()">æ¸…ç©ºæ—¥å¿—</button>
            <button class="test-btn" onclick="runFullTest()">è¿è¡Œå®Œæ•´æµ‹è¯•</button>
        </div>
    </div>

    <script src="js/offline-manager.js"></script>
    <script>
        let testLog = '';
        
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            testLog += `[${timestamp}] ${message}\n`;
            document.getElementById('test-log').textContent = testLog;
            console.log(message);
        }
        
        function updateNetworkStatus() {
            const statusEl = document.getElementById('network-status');
            const isOnline = navigator.onLine;
            
            if (isOnline) {
                statusEl.className = 'status-display status-online';
                statusEl.textContent = 'ğŸŸ¢ åœ¨çº¿çŠ¶æ€ - æ‰€æœ‰åŠŸèƒ½å¯ç”¨';
            } else {
                statusEl.className = 'status-display status-offline';
                statusEl.textContent = 'ğŸ”´ ç¦»çº¿çŠ¶æ€ - éƒ¨åˆ†åŠŸèƒ½å—é™';
            }
            
            log(`ç½‘ç»œçŠ¶æ€: ${isOnline ? 'åœ¨çº¿' : 'ç¦»çº¿'}`);
        }
        
        function testNetworkStatus() {
            updateNetworkStatus();
            
            if (window.offlineManager) {
                const status = offlineManager.getNetworkStatus();
                log(`ç¦»çº¿ç®¡ç†å™¨çŠ¶æ€: ${JSON.stringify(status)}`);
            }
        }
        
        function simulateOffline() {
            log('æ¨¡æ‹Ÿç¦»çº¿çŠ¶æ€...');
            document.body.classList.add('offline-mode');
            
            if (window.offlineManager) {
                offlineManager.handleOfflineMode();
            }
        }
        
        function simulateOnline() {
            log('æ¨¡æ‹Ÿåœ¨çº¿çŠ¶æ€...');
            document.body.classList.remove('offline-mode');
            
            if (window.offlineManager) {
                offlineManager.handleOnlineMode();
            }
        }
        
        function clearLog() {
            testLog = '';
            document.getElementById('test-log').textContent = 'æ—¥å¿—å·²æ¸…ç©º';
        }
        
        function runFullTest() {
            log('å¼€å§‹è¿è¡Œå®Œæ•´æµ‹è¯•...');
            
            // æµ‹è¯•ç½‘ç»œçŠ¶æ€
            testNetworkStatus();
            
            // æµ‹è¯•å›¾æ ‡æ˜¾ç¤º
            const materialIcons = document.querySelectorAll('.material-symbols-rounded');
            log(`å‘ç° ${materialIcons.length} ä¸ª Material Symbols å›¾æ ‡`);
            
            // æµ‹è¯•æœç´¢å¼•æ“å›¾æ ‡
            const searchEngineIcons = document.querySelectorAll('.search-engine-icon');
            log(`å‘ç° ${searchEngineIcons.length} ä¸ªæœç´¢å¼•æ“å›¾æ ‡`);
            
            // æµ‹è¯•ç¦»çº¿ç®¡ç†å™¨
            if (window.offlineManager) {
                log('ç¦»çº¿ç®¡ç†å™¨å·²åŠ è½½');
                const status = offlineManager.getNetworkStatus();
                log(`ç®¡ç†å™¨çŠ¶æ€: ${JSON.stringify(status)}`);
            } else {
                log('âš ï¸ ç¦»çº¿ç®¡ç†å™¨æœªåŠ è½½');
            }
            
            log('å®Œæ•´æµ‹è¯•å®Œæˆ');
        }
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            log('é¡µé¢åŠ è½½å®Œæˆ');
            updateNetworkStatus();
            
            // åˆå§‹åŒ–ç¦»çº¿ç®¡ç†å™¨
            if (window.offlineManager) {
                offlineManager.init();
                log('ç¦»çº¿ç®¡ç†å™¨å·²åˆå§‹åŒ–');
            }
            
            // ç›‘å¬ç½‘ç»œçŠ¶æ€å˜åŒ–
            window.addEventListener('online', () => {
                log('ç½‘ç»œå·²è¿æ¥');
                updateNetworkStatus();
            });
            
            window.addEventListener('offline', () => {
                log('ç½‘ç»œå·²æ–­å¼€');
                updateNetworkStatus();
            });
        });
    </script>
</body>
</html>
